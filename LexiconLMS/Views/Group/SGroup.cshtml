@using System.IdentityModel.Configuration
@using LexiconLMS.Models
@using Microsoft.AspNet.Identity
@model LexiconLMS.Models.Group

@{
    var context = new ApplicationDbContext();
    var currentUserId = User.Identity.GetUserId();

    var currentUser = context.Users.FirstOrDefault(u => u.Id == currentUserId);
    var groupMembers = context.Users.Where(u => u.GroupId == currentUser.GroupId);
    ViewBag.Title = "EIndex";

    var courses = context.Courses.Where(c => c.GroupId == Model.Id);

    var documents = context.Documents.Where(d => d.GroupId == Model.Id);
}
<div>
    <h2>
        Grupp:  @Html.DisplayFor(model => model.Name)
        @if (documents.Any())
        {
            <a href="@Url.Action("Index", "Documents", new { gId = Model.Id }, null)">
                <img src="@Url.Content("~/Content/Images/doc_icon.png")" style="width:25px; height:25px;" />
            </a>
        }
    </h2>

    <h4>@Html.DisplayFor(m => m.StartDate) -- @Html.DisplayFor(m => m.EndDate)</h4>

    <dl class="dl-horizontal">
        <dt>
            @Html.DisplayNameFor(model => model.Description)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.Description)
        </dd>
    </dl>
    <br />
</div>
<div>
    <div class="col-sm-7">
        @Html.Partial("_SGroupCourses", courses)
    </div>
    <div class="col-sm-5">
        @Html.Partial("_SGroupMembers", groupMembers)
    </div>
</div>