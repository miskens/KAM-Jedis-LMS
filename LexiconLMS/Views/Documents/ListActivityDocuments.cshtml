@using LexiconLMS.Models
@model IEnumerable<LexiconLMS.Models.Document>

@{
    ApplicationDbContext context = new ApplicationDbContext();

    ViewBag.Title = "ListActivityDocuments";

    var activityId = ViewData["activityId"].ToString();
    var aId = Int32.Parse(activityId);
    Activity activity = context.Activities.Find(aId);
    ViewData["aId"] = activity.Id;
        
    var courseId = ViewData["courseId"].ToString();
    var cId = Int32.Parse(courseId);
    Course course = context.Courses.Find(cId);
    ViewData["cId"] = course.Id;

    var groupId = course.GroupId;
    Group group = context.Groups.Find(groupId);
    ViewData["gId"] = group.Id;
}

<h2>Document för @activity.Name</h2>

<p>
    @Html.ActionLink("Tillbaka", "Details", "Courses", new { id = course.Id, sender = "g", gId = groupId }, null)
    @Html.ActionLink("Lägg till nytt dokument", "Create", new {sender = "g", gId = groupId, cId = courseId, aId = activityId}, null)
</p>
<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.Uri)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Name)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Description)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.UploadTime)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.GroupId)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.CourseId)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.UserId)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.ActivityId)
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.ActionLink((string)item.Uri, "Details", "Documents", new { id = item.Id, gId = groupId, cId = courseId, aId = activityId}, null)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Name)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Description)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.UploadTime)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.GroupId)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.CourseId)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.UserId)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.ActivityId)
        </td>
        <td>
            @Html.ActionLink("Ta bort", "Delete", new { id=item.Id, gId = groupId, cId = courseId, aId = activityId }, null)
        </td>
    </tr>
}

</table>
