@using System.Data.Entity
@using LexiconLMS.Models
@model LexiconLMS.Models.Course

@{
    ViewBag.Title = "KursDetaljer";

    var context = new ApplicationDbContext();

    var activities = context.Activities.Where(a => a.CourseId == Model.Id);

    string sender = string.Empty;
    if (Request.RequestContext.RouteData.Values["sender"] != null)
    {
        sender = Request.RequestContext.RouteData.Values["sender"].ToString();
    }
    string groupId = "0";
    if (Request.RequestContext.RouteData.Values["gId"] != null)
    {
        groupId = Request.RequestContext.RouteData.Values["gId"].ToString();
    }
    ViewData["CourseId"] = Model.Id;
}
<h2>@Model.Name</h2>
<h4>( @Model.EndDate.ToShortDateString() - @Model.EndDate.ToShortDateString() )</h4>

<div>
    <hr />
    <dl class="dl-horizontal">
        <dt>
            @Html.DisplayNameFor(model => model.Description)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Description)
        </dd>
    </dl>
</div>
<br /><br />
<p>
    @if (sender == "s")
    {
        if (User.IsInRole("lärare"))
        {
            @Html.ActionLink("Ändra", "Edit", new { id = Model.Id, sender, gId = groupId })
        }
        @Html.ActionLink("Tillbaka", "Index", "Home")
    }
    @if (sender == "g")
    {
        if (User.IsInRole("lärare"))
        {
            if (groupId != "0")
            {
                @Html.ActionLink("Tillbaka", "Details", "Group", new { id = groupId }, null)
            }
            else
            {         
                @Html.ActionLink("Tillbaka", "Details", "Group")
            }
        }
        if (User.IsInRole("elev"))
        {
            @Html.ActionLink("Tillbaka", "Index", "Group")
        }
    }
</p>
<br /><br />
<div>
    @Html.Partial("_CourseActivities", activities, ViewData)
</div>
